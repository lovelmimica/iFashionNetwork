<?php
/**
 * Export to PHP Array plugin for PHPMyAdmin
 * @version 4.9.2
 */

/**
 * Database `ifn_recovery`
 */

/* `ifn_recovery`.`_h4y_posts` */
$posts_old = array(
  array('ID' => '19838','post_name' => 'selena-gomez-surprises-fans-at-coachella-2019'),
  array('ID' => '19836','post_name' => 'uniqlo-collaborates-with-alexander-wang-to-launch-exclusive-collection'),
  array('ID' => '19886','post_name' => 'camp-notes-met-gala-2019'),
  array('ID' => '19887','post_name' => 'lady-gaga-at-the-met-gala-from-costumes-changes-to-the-gold-foil-lashes'),
  array('ID' => '19907','post_name' => 'virgine-viard-the-future-of-house-of-chanel'),
  array('ID' => '19911','post_name' => 'guccis-debut-beauty-collection-for-the-bold-the-bright-and-the-beautiful'),
  array('ID' => '20000','post_name' => 'tom-foolery-makes-life-easier-for-women-with-their-drop-seat-jumpsuits-and-rompers'),
  array('ID' => '20001','post_name' => 'rc-caylan-showcases-drama-and-luxury-in-his-collection-at-nyfw'),
  array('ID' => '20004','post_name' => 'fashion-revolution-what-does-this-really-mean'),
  array('ID' => '20043','post_name' => 'the-new-era-of-co-working-how-does-fashion-benefit'),
  array('ID' => '20022','post_name' => '72nd-cannes-film-festival-the-opening-ceremony'),
  array('ID' => '20125','post_name' => 'macs-new-disney-aladdin-makeup-collection-goes-live'),
  array('ID' => '20103','post_name' => 'trends-empowering-women'),
  array('ID' => '20111','post_name' => 'the-power-of-the-runway-through-time'),
  array('ID' => '20042','post_name' => 'gigi-hadid-portrays-four-different-characters-in-burberrys-first-tb-monogram-campaign'),
  array('ID' => '20150','post_name' => 'independent-designers-the-path-to-creative-freedom'),
  array('ID' => '20199','post_name' => 'rihanna-unveils-new-collection-of-fentys-clothing-line'),
  array('ID' => '20189','post_name' => 'purple-magazine-sex-through-the-shape-of-fashion'),
  array('ID' => '20211','post_name' => 'the-glitz-and-glamour-at-the-cannes-film-festival'),
  array('ID' => '20206','post_name' => 'cannes-film-festival-the-closing-ceremony'),
  array('ID' => '20205','post_name' => 'sania-maskatiya-a-touch-of-east-at-nyfw'),
  array('ID' => '19888','post_name' => 'the-futuristic-collection-by-viktoria-tisza-showcased-during-new-york-fashion-week'),
  array('ID' => '20218','post_name' => 'hm-collaborates-with-giambattista-valli-for-their-new-collection'),
  array('ID' => '20208','post_name' => 'the-different-body-types-and-shapes-for-different-women'),
  array('ID' => '20275','post_name' => 'guccis-pre-fall-19-campaign-is-all-about-the-old-world-charm'),
  array('ID' => '20296','post_name' => 'fantasy-style-elements-by-hakuyo-miya-at-nyfw'),
  array('ID' => '20297','post_name' => 'imogen-evans-sends-a-social-message-through-her-collection-at-nyfw'),
  array('ID' => '20299','post_name' => 'ruth-zabetta-takes-inspiration-from-the-buildings-of-new-york-city-for-her-latest-collection'),
  array('ID' => '20443','post_name' => 'self-portrait-fall-winter19-showcasing'),
  array('ID' => '20427','post_name' => 'jeremy-scott-presents-fake-news-inspired-fashion-at-nyfw'),
  array('ID' => '20414','post_name' => 'cushnie-fall-winter19-collection-an-ode-to-the-20s-and-paul-poiret'),
  array('ID' => '20395','post_name' => 'badgley-mischka-revamp-the-post-war-glamour-at-the-nyfw'),
  array('ID' => '20368','post_name' => 'pamella-roland-presents-at-the-fall-winter19-showcasing-at-nyfw'),
  array('ID' => '20352','post_name' => 'tom-ford-open-the-nyfw-for-the-fall-winter19-showcasing'),
  array('ID' => '20278','post_name' => 'tadashi-shoji-brings-south-east-asia-to-nyfw'),
  array('ID' => '20394','post_name' => 'an-interview-with-anthony-sanchez-haute-couture'),
  array('ID' => '20479','post_name' => 'christian-siriano-futuristic-theme-fall-winter-collection-at-nyfw'),
  array('ID' => '20294','post_name' => 'victoria-ceron-wasted-clothes-transformed-into-beautiful-fabrics'),
  array('ID' => '20464','post_name' => 'japanese-inspired-collection-by-adeam-at-nyfw'),
  array('ID' => '20497','post_name' => 'jonathan-simkhai-heros-the-humble-scarf-at-nyfw'),
  array('ID' => '20518','post_name' => 'brandon-maxwell-dedicates-his-elegant-fall19-collection-to-his-mother'),
  array('ID' => '20555','post_name' => 'mansur-gavriel-present-a-minimalistic-collection-at-the-nyfw'),
  array('ID' => '20533','post_name' => 'area-presents-new-trends-at-the-fall-winter19-showcasing-at-nyfw'),
  array('ID' => '20567','post_name' => 'suitcases-of-the-world-prabal-gurung-at-the-ny-fashion-week'),
  array('ID' => '20283','post_name' => 'unfashionable-fashion-styles-aim-to-manifest'),
  array('ID' => '19829','post_name' => 'kim-k-reveals-her-dreams-to-be-a-lawyer-and-that-makes-sense'),
  array('ID' => '19831','post_name' => 'glitter-makeup-rules-in-coachella-2019'),
  array('ID' => '20614','post_name' => '3-1-phillip-lim-presents-a-marie-kondo-inspired-collection'),
  array('ID' => '20578','post_name' => 'spy-inspired-collection-by-zimmermann-at-the-nyfw'),
  array('ID' => '20595','post_name' => 'laquan-smith-at-the-nyfw-for-the-fall-winter19-showcasing'),
  array('ID' => '20628','post_name' => 'proenza-schouler-at-nyfw-for-the-fall19-collection'),
  array('ID' => '20655','post_name' => 'elvis-presley-inspired-collection-by-sally-lapointe'),
  array('ID' => '20643','post_name' => 'cheerful-collection-by-anna-sui-at-nyfw'),
  array('ID' => '20665','post_name' => 'school-daze-victor-glemaud-at-the-nyfw'),
  array('ID' => '20707','post_name' => 'oscar-de-la-renta-bring-spain-to-nyfw'),
  array('ID' => '20711','post_name' => 'a-collection-by-marchesa-at-the-nyfw'),
  array('ID' => '20709','post_name' => 'the-visionary-mcqueen-what-lee-left-us'),
  array('ID' => '20730','post_name' => 'marc-jacobs-a-scaled-back-couture-collection'),
  array('ID' => '20745','post_name' => 'boss-simplicity-and-refinement-at-nyfw'),
  array('ID' => '20763','post_name' => 'naeem-khan-brings-his-70s-life-to-the-nyfw'),
  array('ID' => '20794','post_name' => 'bibhu-mohapatra-celebrates-at-the-nyfw'),
  array('ID' => '20807','post_name' => 'christian-cowan-a-fun-neon-collection'),
  array('ID' => '20824','post_name' => 'cynthia-rowley-a-fun-flirty-retro-fashion-at-nyfw'),
  array('ID' => '20839','post_name' => 'helmut-lang-at-the-nyfw'),
  array('ID' => '20854','post_name' => 'chanel-metiers-dart-show-18-19-at-seoul'),
  array('ID' => '20870','post_name' => 'fall-2019-couture-maison-francesco-scognamiglio'),
  array('ID' => '20889','post_name' => 'fall-2019-couture-fendi'),
  array('ID' => '20890','post_name' => 'fall-2019-couture-zuhair-murad'),
  array('ID' => '20963','post_name' => 'fall-2019-couture-valentino'),
  array('ID' => '21016','post_name' => 'fall-2019-couture-viktor-rolf'),
  array('ID' => '21214','post_name' => 'fall19-couture-elie-saab'),
  array('ID' => '21215','post_name' => 'fall-2019-couture-maison-margiela'),
  array('ID' => '21211','post_name' => 'fall19-couture-givenchy'),
  array('ID' => '21266','post_name' => 'fall19-couture-jean-paul-gaultier'),
  array('ID' => '21328','post_name' => 'fall19-couture-armani-prive'),
  array('ID' => '21415','post_name' => 'fashion-at-the-cfda-awards-2019'),
  array('ID' => '21512','post_name' => 'dior-from-paris-to-the-world-opens-in-dallas'),
  array('ID' => '21153','post_name' => 'the-best-court-side-wimbledon-fashion-2019'),
  array('ID' => '21414','post_name' => 'fall19-couture-alexandre-vauthier'),
  array('ID' => '21604','post_name' => 'fall19-couture-chanel'),
  array('ID' => '21605','post_name' => 'fall19-couture-ralph-and-russo'),
  array('ID' => '21606','post_name' => 'fall19-couture-giambattista-valli'),
  array('ID' => '21610','post_name' => 'fall19-couture-alberta-ferretti-limited-edition'),
  array('ID' => '21611','post_name' => 'fall19-couture-dundas'),
  array('ID' => '21609','post_name' => 'fall19-couture-alexis-mabille'),
  array('ID' => '21523','post_name' => 'venice-film-festival-red-carpet-day-1'),
  array('ID' => '21857','post_name' => 'vmas-2019-the-red-carpet'),
  array('ID' => '21869','post_name' => 'venice-film-festival-day-2'),
  array('ID' => '21894','post_name' => 'venice-film-festival-red-carpet-day-3'),
  array('ID' => '21910','post_name' => 'venice-film-festival-red-carpet-day-4'),
  array('ID' => '21918','post_name' => 'venice-film-festival-red-carpet-day-5'),
  array('ID' => '21997','post_name' => 'caafd-announces-new-designers-for-the-nyfw-2'),
  array('ID' => '21945','post_name' => 'the-gq-awards-red-carpet'),
  array('ID' => '21941','post_name' => 'venice-film-festival-red-carpet-day-6'),
  array('ID' => '22215','post_name' => 'vaishali-s-spring-summer-20-collection-receives-fashion-critics-nod-at-the-caafd-nyfw-solo-showcase'),
  array('ID' => '22199','post_name' => 'moon-chang-showcased-spring-summer-20-collection-during-caafd-nyfw-leaving-audience-in-awe'),
  array('ID' => '22167','post_name' => 'paraguayan-fashion-designer-shines-bright-with-colorful-silhouettes-maria-sonia-spring-summer-20-collection-showcased-during-caafd-nyfw-designer-collective'),
  array('ID' => '22123','post_name' => 'temraza-spring-summer-20-outshines-with-flare-and-elegance-couture-during-nyfw-presented-by-caafd'),
  array('ID' => '22150','post_name' => 'phoenix-ba-spring-summer-20-floral-motifs-collection-exhibits-majesty-during-caafd-nyfw'),
  array('ID' => '22198','post_name' => 'a-humming-way-spring-summer-20-collection-met-with-warmth-and-excitement-during-caafd-nyfw'),
  array('ID' => '22032','post_name' => 'fall19-couture-christian-dior'),
  array('ID' => '21989','post_name' => 'yufash-returns-to-nyfw-showing-spring-summer-20-collection-exhibited-pure-elegance-with-minimalism'),
  array('ID' => '21608','post_name' => 'fall19-couture-antonio-grimaldi-takes-the-runway-on-black-and-white'),
  array('ID' => '21607','post_name' => 'fall19-couture-iris-van-herpen'),
  array('ID' => '22257','post_name' => 'caafd-emerging-designers-outshine-during-nyfw-ss20-collective-showcasing'),
  array('ID' => '22273','post_name' => 'spring-summer-2020-collection-at-nyfw-anna-sui'),
  array('ID' => '22168','post_name' => 'spring-summer-2020-collection-nyfw-afffair'),
  array('ID' => '22493','post_name' => 'spring-summer-2020-collection-at-nyfw-cong-tri'),
  array('ID' => '22620','post_name' => 'spring-summer-2020-collection-at-nyfw-dennis-basso'),
  array('ID' => '22673','post_name' => 'spring-summer-2020-collection-at-nyfw-elie-tahari'),
  array('ID' => '22738','post_name' => 'spring-summer-2020-collection-at-nyfw-helmut-lang'),
  array('ID' => '22781','post_name' => 'spring-summer-2020-collection-at-nyfw-jason-wu-collection'),
  array('ID' => '22782','post_name' => 'spring-summer-2020-collection-at-nyfw-jeremy-scott'),
  array('ID' => '22841','post_name' => 'spring-summer-2020-collection-at-nyfw-jonathan-simkhai'),
  array('ID' => '22308','post_name' => 'spring-summer-2020-collection-at-nyfw-badgley-mischka'),
  array('ID' => '22558','post_name' => 'spring-summer-2020-collection-at-nyfw-concept-korea'),
  array('ID' => '22366','post_name' => 'spring-summer-2020-collection-at-nyfw-brandon-maxwell'),
  array('ID' => '22490','post_name' => 'spring-summer-2020-collection-at-nyfw-christian-siriano'),
  array('ID' => '22987','post_name' => 'self-portrait-spring-summer-2020-collection'),
  array('ID' => '22934','post_name' => 'sally-lapointe-spring-summer-2020-collection'),
  array('ID' => '23027','post_name' => 'tom-ford-spring-summer-2020-collection'),
  array('ID' => '23113','post_name' => 'brands-to-lookout-for-temraza'),
  array('ID' => '26686','post_name' => 'zac-posen-shuts-down-his-namesake-fashion-brand'),
  array('ID' => '23126','post_name' => 'marc-jacobs-spring-summer-2020-collection'),
  array('ID' => '26696','post_name' => 'savage-x-fenty-announces-new-campaign-face-for-their-brand'),
  array('ID' => '26692','post_name' => 'met-gala-2020-theme-revealed'),
  array('ID' => '23033','post_name' => 'pyer-moss-spring-summer-2020-collection'),
  array('ID' => '26826','post_name' => 'fashion-trends-that-are-dying-in-2020'),
  array('ID' => '26869','post_name' => 'top-beauty-products-of-2019-leading-into-2020'),
  array('ID' => '26924','post_name' => 'billie-eilish-collaborates-with-hm'),
  array('ID' => '26892','post_name' => 'kate-hudson-launches-new-eco-evening-collection'),
  array('ID' => '26890','post_name' => 'sisters-launch-new-perfume-natalie-dylana-edp'),
  array('ID' => '26888','post_name' => 'barneys-shuts-online-operations-as-it-awaits-its-takeover'),
  array('ID' => '26886','post_name' => 'top-5-most-seductive-perfumes-for-women-worth-buying'),
  array('ID' => '26820','post_name' => 'how-to-look-fashionably-classy-and-polished-at-all-times'),
  array('ID' => '26839','post_name' => 'fitness-from-flab-to-fab-easy-weight-loss-tips'),
  array('ID' => '26941','post_name' => 'marks-spencer-launches-activewear'),
  array('ID' => '26694','post_name' => 'hm-announces-collaboration-with-latin-american-designer-johanna-ortiz'),
  array('ID' => '26947','post_name' => 'vogue-italia-ditches-photoshoot-in-january-issue'),
  array('ID' => '26698','post_name' => 'jennifer-lopez-is-the-new-global-ambassador-for-luxury-brand-coach'),
  array('ID' => '26984','post_name' => 'frank-ocean-is-the-new-face-of-prada'),
  array('ID' => '26688','post_name' => 'classic-blue-the-color-for-2020'),
  array('ID' => '27155','post_name' => 'tom-ford-fashion-week-fall-2020'),
  array('ID' => '27204','post_name' => 'jason-wu-collection-fall-2020-collection'),
  array('ID' => '27141','post_name' => 'helmut-lang-fall-2020-collection'),
  array('ID' => '27253','post_name' => 'self-portrait-fall-2020-collection'),
  array('ID' => '27736','post_name' => 'giambattista-valli-fall-2020-collection'),
  array('ID' => '27101','post_name' => 'sally-lapointe-fall-2020-collection'),
  array('ID' => '27315','post_name' => 'brandon-maxwell-fall-2020-collection'),
  array('ID' => '27788','post_name' => 'tommy-hilfiger-2020-spring-summer-collection')
);

require_once("../../../wp-load.php");
// $i = 0;

// $posts_new = get_posts( array( 'numberposts' => -1 ) );

// $i = 0;
// $j = 0;
// foreach( $posts_new as $post_new ){
//   if( str_contains( $post_new->post_content, "?p=" ) ){
//     $rel_link_start = strpos( $post_new->post_content, "?p=" );
//     $offset = $rel_link_start + 3;
//     $rel_link_end = strpos( $post_new->post_content, "&", $offset );
//     $rel_link_length = $rel_link_end - $rel_link_start;

//     $rel_link = substr( $post_new->post_content, $rel_link_start, $rel_link_length );

//     $rel_link_id_old = substr( $rel_link, 3 );

//     foreach( $posts_old as $post_old ){
//       if( $post_old['ID'] == $rel_link_id_old ){
//         error_log( $j . ". Post " . $post_new->post_name . " contains related link to: " . $post_old['post_name'] );

//         $rel_link_id_new = get_posts(  array( 'name' => $post_old['post_name'] ) )[0]->ID;

//         $post_content_new = str_replace( $rel_link, "?p=" . $rel_link_id_new, $post_new->post_content );

//         $args = array( 
//           'ID' => $post_new->ID,
//           'post_content' => $post_content_new
//         );
//         $update_result = wp_update_post( $args );

//         if( $update_result ) error_log( "Updated post " . $post_new->post_name );
//         else error_log( "Error while updating post " . $post_new->post_name );

//         $j++;
//         break;
//       }
//     }    
//   }
//   $i++;
// }

// error_log( "Total replacements: " . $j );

$posts = get_posts( array( 'numberposts' => -1 ) );
$i = 0;
$j = 0;
foreach( $posts as $post ){
  if( str_contains( $post->post_content, "www.localhost/" ) ){
    error_log( "Post contains related post link: " . $post->post_name );
    $post_content_new = str_replace( "www.localhost/", "localhost/", $post->post_content );

    $args = array( 
      'ID' => $post->ID,
      'post_content' => $post_content_new
    );
    $update_result = wp_update_post( $args );

    if( $update_result ) error_log( "Updated post " . $post->post_name );
    else error_log( "Error while updating post " . $post->post_name );
    
    $j++;
  }
  $i++;
}

error_log( "Total replacements: " . $j );